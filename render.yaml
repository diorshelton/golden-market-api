services:
  # Golden Market API - Backend Service
  - type: web
    name: golden-market-api
    runtime: go
    plan: free
    branch: develop
    buildCommand: go build -o bin/api ./cmd/api
    startCommand: ./bin/api
    envVars:
      # Go Version
      - key: GO_VERSION
        value: 1.25.0

      # Database (Neon)
      - key: DATABASE_URL
        sync: false  # Must be set manually in Render dashboard

      # JWT Configuration
      - key: JWT_SECRET
        generateValue: true
      - key: REFRESH_SECRET
        generateValue: true
      - key: ACCESS_TOKEN_EXPIRY
        value: 15m
      - key: REFRESH_TOKEN_EXPIRY
        value: 168h

      # CORS Configuration
      - key: ALLOWED_ORIGINS
        value: https://diorshelton.github.io

      # Application Settings
      - key: PORT
        value: 8080
      - key: ENVIRONMENT
        value: production

    # Health check endpoint
    healthCheckPath: /health

    # Auto-deploy settings
    autoDeploy: true
